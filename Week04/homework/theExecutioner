import argparse 
from fileSearchTerms import yamlParse, directoryTraversal, logScan, returnResults

parser = argparse.ArgumentParser(
    description="Traverses directory and builds an output that identifies attacks.",
    epilog="Developed by John Tiseo 20220210"
)

# Add argument to pass to the filesearchterms.py program
parser.add_argument("-d", "--directory", required="True", help="Tell me the directory you want to parse.")
parser.add_argument("-s", "--scanfor", required="True", help="Tell me the type of attack you want to scan for.")

# Parse arguments
args = parser.parse_args()

searchTerms = yamlParse("searchTerms.yaml")

# Directory of choice
rootdir = args.directory
# .Yaml book of choice
book = args.scanfor


for eachFile in fList:
    results = (log_scan(eachFile, searchterms, book))
    for x in results:
        returnResults(x)